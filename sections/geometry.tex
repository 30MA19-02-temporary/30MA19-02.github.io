% !TeX root = ../main.tex

\documentclass[../main.tex]{subfiles}

\begin{document}
\section{Geometric properties}
\subsection{Embedding}
\begin{definition}\label{M:Embedding}
    Let $N=\left(Q,g\right)$ be a $n$-dimension Riemannian manifold
    on position parameter space with such inner product $g$ that
    the map $f={\psi_0}^{-1}$
    is an isometric embedding to $\left(n+1\right)$-manifold
    with the metric of $g=\diag{\left(\sign{k},1,\dots,1\right)}$.
\end{definition}
\begin{lemma}\label{M:Tangent:Basis}
    Position parameter $\tensor{\theta}{^i}$ is associated to the following vector in position vector space.
    \begin{equation*}
        \frac{\partial}{\partial\tensor{\theta}{^i}} =
        \begin{pmatrix}
            -k\tan_k^\ast\tensor{\theta}{^i}\tensor{p}{^j}         \\
            k\frac{1}{\tan_k\tensor{\theta}{^i}}\tensor{p}{^{i+1}} \\
            0
        \end{pmatrix} \frac{\partial}{\partial\tensor{p}{^j}}
    \end{equation*}
\end{lemma}
\begin{proof}[\proofof{M:Tangent:Basis}]
    \begin{align*}
        \frac{\partial}{\partial\tensor{\theta}{^i}}
                                                                                                       & = \frac{\partial\tensor{p}{^j}}{\partial\tensor{\theta}{^i}}\frac{\partial}{\partial\tensor{p}{^j}} \\
                                                                                                       & = \frac{\partial}{\partial\tensor{\theta}{^i}}
        \left[
            \frac{1}{k}
            \begin{pmatrix}
                \prod_{l\in\Set{1..n}}{\cos_k{\tensor{\theta}{^l}}}                                \\
                \sin_k{\tensor{\theta}{^{j-1}}}\prod_{l\in\Set{j..n}}{\cos_k{\tensor{\theta}{^l}}} \\
                \sin_k{{\tensor{\theta}{^n}}}                                                      \\
            \end{pmatrix}
        \right]\frac{\partial}{\partial\tensor{p}{^j}}                                                 & \text{\cref{M:Vector:Value}}                                                                        \\
                                                                                                       & =
        \frac{1}{k}
        \frac{\partial}{\partial\tensor{\theta}{^i}}
        \left[
            \begin{pmatrix}
                \prod_{l\in\Set{1..n}}{\cos_k{\tensor{\theta}{^l}}}                                \\
                \sin_k{\tensor{\theta}{^{j-1}}}\prod_{l\in\Set{j..n}}{\cos_k{\tensor{\theta}{^l}}} \\
                \sin_k{{\tensor{\theta}{^n}}}                                                      \\
            \end{pmatrix}
        \right]\frac{\partial}{\partial\tensor{p}{^j}}                                                                                                                                                       \\
                                                                                                       & =
        \frac{1}{k}
        \left[
            \begin{pmatrix}
                -k\sin_k^\ast{\tensor{\theta}{^i}}\prod_{l\in\Set{1..n}/\Set{i}}{\cos_k{\tensor{\theta}{^l}}}                                \\
                -k\sin_k^\ast{\tensor{\theta}{^i}}\sin_k{\tensor{\theta}{^{j-1}}}\prod_{l\in\Set{j..n}/\Set{i}}{\cos_k{\tensor{\theta}{^l}}} \\
                k\cos_k{\tensor{\theta}{^{i}}}\prod_{l\in\Set{i+1..n}}{\cos_k{\tensor{\theta}{^l}}}                                          \\
                0                                                                                                                            \\
            \end{pmatrix}
        \right]\frac{\partial}{\partial\tensor{p}{^j}}                                                 & \text{\cref{M:Trigonometry:Derivative}}                                                             \\
                                                                                                       & =
        \begin{pmatrix}
            -\tan_k^\ast{\tensor{\theta}{^i}}\prod_{l\in\Set{1..n}}{\cos_k{\tensor{\theta}{^l}}}                                \\
            -\tan_k^\ast{\tensor{\theta}{^i}}\sin_k{\tensor{\theta}{^{j-1}}}\prod_{l\in\Set{j..n}}{\cos_k{\tensor{\theta}{^l}}} \\
            \frac{1}{\tan_k{\tensor{\theta}{^{i}}}}\prod_{l\in\Set{i+1..n}}{\cos_k{\tensor{\theta}{^l}}}                        \\
            0                                                                                                                   \\
        \end{pmatrix}
        \frac{\partial}{\partial\tensor{p}{^j}}                                                                                                                                                              \\
                                                                                                       & =
        \begin{pmatrix}
            -k\tan_k^\ast\tensor{\theta}{^i}\tensor{p}{^j}         \\
            k\frac{1}{\tan_k\tensor{\theta}{^i}}\tensor{p}{^{i+1}} \\
            0
        \end{pmatrix} \frac{\partial}{\partial\tensor{p}{^j}} & \text{\cref{M:Vector:Value}}                                                                                                          \\
    \end{align*}
\end{proof}
\begin{lemma}\label{M:MetricTensor}
    The metric tensor of $N$ at $\tensor{\theta}{}$is
    \begin{align*}
        \tensor{g}{_a_b} & =
        \begin{cases}
            \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}} & \text{if $a=b$,}  \\
            0                                        & \text{otherwise.} \\
        \end{cases}
    \end{align*}
\end{lemma}
\begin{proof}[\proofof{M:MetricTensor}]
    \begin{align*}
        \tensor{g}{_a_b}\left[\frac{\partial}{\partial\tensor{\theta}{^i}}\right]
         & = \sum_{l,m=1}^{n+1}{
        \frac{\partial{\tensor{p}{^l}}}{\partial{\tensor{\theta}{^a}}}
        \tensor{g}{_l_m}\left[\frac{\partial}{\partial\tensor{p}{^i}}\right]
        \frac{\partial{\tensor{p}{^m}}}{\partial{\tensor{\theta}{^b}}}
        }                        \\
         & =
        \left(\sign{k}\right)
        \frac{\partial{\tensor{p}{^1}}}{\partial{\tensor{\theta}{^a}}}
        \frac{\partial{\tensor{p}{^1}}}{\partial{\tensor{\theta}{^b}}}
        +
        \sum_{l=2}^{n+1}{
        \frac{\partial{\tensor{p}{^l}}}{\partial{\tensor{\theta}{^a}}}
        \frac{\partial{\tensor{p}{^l}}}{\partial{\tensor{\theta}{^b}}}
        }
    \end{align*}

    If $a<b$,
    \begin{align*}
        \tensor{g}{_a_b}
         & =\begin{pmatrix}
                -k\tan_k^\ast\left(\tensor{\theta}{^a}\right)\tensor{p}{^j}         \\
                k\frac{1}{\tan_k\left(\tensor{\theta}{^a}\right)}\tensor{p}{^{a+1}} \\
                0                                                                   \\
            \end{pmatrix}
        \tensor{g}{}\left[\frac{\partial}{\partial\tensor{p}{^i}}\right]
        \begin{pmatrix}
            -k\tan_k^\ast\left(\tensor{\theta}{^b}\right)\tensor{p}{^j}         \\
            k\frac{1}{\tan_k\left(\tensor{\theta}{^b}\right)}\tensor{p}{^{b+1}} \\
            0                                                                   \\
        \end{pmatrix}                         \\
         & =
        \left(\sign{k}\right) k^2\tan_k^\ast\left(\tensor{\theta}{^a}\right)\tan_k^\ast\left(\tensor{\theta}{^b}\right){\tensor{p}{^1}}^2
        +
        \sum_j{
            k^2\tan_k^\ast\left(\tensor{\theta}{^a}\right)\tan_k^\ast\left(\tensor{\theta}{^b}\right){\tensor{p}{^j}}^2
        }
        -k^2\frac{\tan_k^\ast\left(\tensor{\theta}{^b}\right)}{\tan_k\left(\tensor{\theta}{^a}\right)}{\tensor{p}{^{a+1}}}^2 \\
         & =
        \tan_k\left(\tensor{\theta}{^b}\right)
        \tan_k\left(\tensor{\theta}{^a}\right)
        \prod_{a\le j\le n+1}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \left(\sign{k}\right)
        \prod_{1\le j<a}{\cos_k^2\tensor{\theta}{^j}}
        + \sum{
            \sin_k^2{\tensor{\theta}{^{i}}}\prod_{i<j<a}{\cos_k^2\tensor{\theta}{^j}}
        }
        -\sign{k}
        \right)                                                                                                              \\
         & =
        \tan_k\left(\tensor{\theta}{^b}\right)
        \tan_k\left(\tensor{\theta}{^a}\right)
        \prod_{a\le j\le n+1}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \left(\sign{k}\right)
        \prod_{1\le j<a}{\cos_k^2\tensor{\theta}{^j}}
        + \sign{k}\left(
        1-\prod_{1\le j<a}{\cos_k^2\tensor{\theta}{^j}}
        \right)
        - \sign{k}
        \right)                                                                                                              \\
        \tensor{g}{_a_b}
         & = 0 \text{.}
    \end{align*}

    If $a>b$, $\tensor{g}{_a_b}=\tensor{g}{_b_a}=0$.

    If $a=b$,
    \begin{align*}
        \tensor{g}{_a_a}
         & =\begin{pmatrix}
                -k\tan_k^\ast\tensor{\theta}{^a}\tensor{p}{^j}         \\
                k\frac{1}{\tan_k\tensor{\theta}{^a}}\tensor{p}{^{a+1}} \\
                0                                                      \\
            \end{pmatrix}
        \tensor{g}{}\left[\frac{\partial}{\partial\tensor{p}{^i}}\right]
        \begin{pmatrix}
            -k\tan_k^\ast\tensor{\theta}{^a}\tensor{p}{^j}         \\
            k\frac{1}{\tan_k\tensor{\theta}{^a}}\tensor{p}{^{a+1}} \\
            0
        \end{pmatrix}     \\
         & =
        \left(\sign{k}\right)\left(k\tensor{p}{^1}\tan_k^\ast\tensor{\theta}{^a}\right)^2
        +\sum_j{\left(k\tensor{p}{^j}\tan_k^\ast\tensor{\theta}{^a}\right)^2}
        +\left(k\tensor{p}{^{a+1}}\cot_k\tensor{\theta}{^a}\right)^2                                     \\
         & =
        \left(\sign{k}\right)\left(k\tensor{p}{^1}\tan_k\tensor{\theta}{^a}\right)^2
        +\sum_j{\left(k\tensor{p}{^j}\tan_k\tensor{\theta}{^a}\right)^2}
        +\left(k\tensor{p}{^{a+1}}\cot_k\tensor{\theta}{^a}\right)^2                                     \\
         & =
        \sin_k^2\left(\tensor{\theta}{^a}\right)
        \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \left(\sign{k}\right)
        \prod_{1\le j<a}{\cos_k^2\tensor{\theta}{^j}}
        + \sum_{1\le i<a}{
            \sin_k^2{\tensor{\theta}{^{i}}}\prod_{i<j<a}{\cos_k^2\tensor{\theta}{^j}}
        }
        +\cot_k^2\left(\tensor{\theta}{^a}\right)
        \right)                                                                                          \\
         & =
        \sin_k^2\left(\tensor{\theta}{^a}\right)
        \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \left(\sign{k}\right)
        \prod_{1\le j<a}{\cos_k^2\tensor{\theta}{^j}}
        + \sum_{1\le i<a}{
            \sin_k^2{\tensor{\theta}{^{i}}}\prod_{i<j<a}{\cos_k^2\tensor{\theta}{^j}}
        }
        +\cot_k^2\left(\tensor{\theta}{^a}\right)
        \right)                                                                                          \\
         & =
        \sin_k^2\left(\tensor{\theta}{^a}\right)
        \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \sign{k}
        +\cot_k^2\left(\tensor{\theta}{^a}
            \right)
        \right)                                                                                          \\
         & =
        \sin_k^2\left(\tensor{\theta}{^a}\right)
        \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \sign{k}
        +\csc_k^2\left(\tensor{\theta}{^a}
            -\sign{k}
            \right)
        \right)                                                                                          \\
         & =
        \sin_k^2\left(\tensor{\theta}{^a}\right)
        \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}}
        \left(
        \csc_k^2\left(\tensor{\theta}{^a}
            \right)
        \right)                                                                                          \\
         & =
        \prod_{a<j}{\cos_k^2\tensor{\theta}{^j}}
    \end{align*}
\end{proof}
\subsection{Curvature}
\begin{lemma}\label{M:Christoffel}
    The Christoffel symbols of the manifold
    at the point $\tensor{p}{}=f\left(\tensor{\theta}{}\right)$
    is
    \begin{equation*}
        \tensor{\Gamma}{^l_i_j}= \begin{cases}
            -k\tan_k^\ast\tensor{\theta}{^j} & \text{$l=i<j$} \\
            -k\tan_k^\ast\tensor{\theta}{^i} & \text{$l=j<i$} \\
            -k\tan_k^\ast\tensor{\theta}{^l}\prod_{i<a\le l}{\cos_k^2\tensor{\theta}{^a}} & \text{$i=j<l$} \\
            0 & \text{otherwise} \\
        \end{cases}
    \end{equation*}
\end{lemma}
\begin{proof}[\proofof{M:Christoffel}]
    \begin{align*}
        \tensor{g}{_i_j_{,m}}
        &=
        \frac{\partial\tensor{g}{_i_j}}{\partial\tensor{\theta}{^m}} \\
        &= \begin{cases}
            \frac{partial}{\partial\tensor{\theta}{^m}} \prod_{i<a}{\cos_k^2\tensor{\theta}{^a}} & \text{$i=j$} \\
            \frac{partial}{\partial\tensor{\theta}{^m}} 0 & \text{$i\ne j$} \\
        \end{cases} \\
        &= \begin{cases}
            -2k\tan_k^\ast\tensor{\theta}{^m}\prod_{i<a}{\cos_k^2\tensor{\theta}{^a}} & \text{$i=j<m$} \\
            0 & \text{otherwise} \\
        \end{cases} \\
        &= \begin{cases}
            -2k\tan_k^\ast\tensor{\theta}{^m}\tensor{g}{_i_i} & \text{$i=j<m$} \\
            0 & \text{otherwise} \\
        \end{cases}
    \end{align*}
    \begin{align*}
        \tensor{g}{}&=\diag\left(\tensor{g}{_i_i}\right) \\
        {\tensor{g}{}}^{-1}&=\diag\left({\tensor{g}{_i_i}}^{-1}\right) \\
        \tensor{g}{^i^j}&=\begin{cases}
            {\tensor{g}{_i_i}}^{-1} & \text{$i=j$} \\
            0 & \text{$i\ne j$} \\
        \end{cases}
    \end{align*}
    \begin{align*}
        \tensor{\Gamma}{^l_i_j}
        &=
        \frac{1}{2}
        \sum_{m}\left(
            \tensor{g}{^l^m}
            \left(
                \tensor{g}{_m_i_{,j}}
                + \tensor{g}{_m_j_{,i}}
                - \tensor{g}{_i_j_{,m}}
            \right)
        \right) \\
        &=
        \frac{1}{2}
        {\tensor{g}{_l_l}}^{-1}
        \left(
            \tensor{g}{_l_i_{,j}}
            + \tensor{g}{_l_j_{,i}}
            - \tensor{g}{_i_j_{,l}}
        \right) \\
        &= \begin{cases}
            -k\tan_k^\ast\tensor{\theta}{^j} & \text{$l=i<j$} \\
            -k\tan_k^\ast\tensor{\theta}{^i} & \text{$l=j<i$} \\
            -k\tan_k^\ast\tensor{\theta}{^l}\frac{\tensor{g}{_i_i}}{\tensor{g}{_l_l}} & \text{$i=j<l$} \\
            0 & \text{otherwise} \\
        \end{cases} \\
        &= \begin{cases}
            -k\tan_k^\ast\tensor{\theta}{^j} & \text{$l=i<j$} \\
            -k\tan_k^\ast\tensor{\theta}{^i} & \text{$l=j<i$} \\
            -k\tan_k^\ast\tensor{\theta}{^l}\prod_{i<a\le l}{\cos_k^2\tensor{\theta}{^a}} & \text{$i=j<l$} \\
            0 & \text{otherwise} \\
        \end{cases}
    \end{align*}
\end{proof}
\begin{lemma}\label{M:CurvatureTensor}
    The curvature tensor of the manifold
    at the point $\tensor{p}{}=f\left(\tensor{\theta}{}\right)$
    is
    \begin{equation*}
        \tensor{R}{^s_i_j_l}=
    \end{equation*}
\end{lemma}
\begin{proof}[\proofof{M:CurvatureTensor}]
    \begin{align*}
        \tensor{R}{^s_i_j_l}
        &=
        \frac{\partial}{\partial\tensor{u}{^l}}\tensor{\Gamma}{^s_i_j}
        - \frac{\partial}{\partial\tensor{u}{^j}}\tensor{\Gamma}{^s_i_l}
        + \sum_{r}\left(\tensor{\Gamma}{^r_i_j}\tensor{\Gamma}{^s_r_l}-\tensor{\Gamma}{^r_i_l}\tensor{\Gamma}{^s_r_j}\right)
    \end{align*}
\end{proof}
\begin{lemma}\label{M:SectionalCurvature}
    The sectional curvature of the manifold
    at the point $\tensor{p}{}=f\left(\tensor{\theta}{}\right)$
    along the tangent vector $\tensor{u}{}$ and $\tensor{v}{}$
    is
    \begin{equation*}
        K\left(\tensor{u}{},\tensor{v}{}\right)=\sign{k}k^2
    \end{equation*}
\end{lemma}
\begin{proof}[\proofof{M:SectionalCurvature}]
    \begin{align*}
        K\left(\tensor{u}{},\tensor{v}{}\right)
        &=
        \frac{
            \inner{R\left(\tensor{u}{},\tensor{v}{}\right)\tensor{v}{}}{\tensor{u}{}}
        }{
            \inner{\tensor{u}{}}{\tensor{u}{}}
            \inner{\tensor{v}{}}{\tensor{v}{}}
            -\inner{\tensor{u}{}}{\tensor{v}{}}^2
        } \\
        &=
        \frac{
            \inner{
                \contr{\left(\contr^2{\left(\tensor{R}{}\otimes\tensor{v}{}\otimes\tensor{u}{}\right)}\otimes\tensor{v}{}\right)}
            }{\tensor{u}{}}
        }{
            \inner{\tensor{u}{}}{\tensor{u}{}}
            \inner{\tensor{v}{}}{\tensor{v}{}}
            -\inner{\tensor{u}{}}{\tensor{v}{}}^2
        } \\
        &=
        \frac{
            \contr^2{\left(\tensor{g}{}\otimes\tensor{u}{}\otimes\contr^3\left(\tensor{R}{}\otimes\tensor{v}{}\otimes\tensor{u}{}\otimes\tensor{v}{}\right)\right)}
        }{
            \contr^2{\left(\tensor{g}{}\otimes\tensor{u}{}\otimes\tensor{u}{}\right)}
            \contr^2{\left(\tensor{g}{}\otimes\tensor{v}{}\otimes\tensor{v}{}\right)}
            -\contr^2{\left(\tensor{g}{}\otimes\tensor{u}{}\otimes\tensor{v}{}\right)}^2
        } \\
        &=
        \frac{
            \sum_{i,j,a,b,c}{\left(\tensor{g}{_i_j}\tensor{u}{^j}\tensor{R}{^i_c_a_b}\tensor{v}{^b}\tensor{u}{^a}\tensor{v}{^c}\right)}
        }{
            \sum_{i,j}\left(\tensor{g}{_i_j}\tensor{u}{^j}\tensor{u}{^i}\right)
            \sum_{i,j}\left(\tensor{g}{_i_j}\tensor{v}{^j}\tensor{v}{^i}\right)
            -\left(\sum_{i,j}\left(\tensor{g}{_i_j}\tensor{v}{^j}\tensor{u}{^i}\right)\right)^2
        } \\
        &=
        \frac{
            \sum_{i,a,b,c}{\left(\tensor{g}{_i_i}\tensor{u}{^i}\tensor{R}{^i_c_a_b}\tensor{v}{^b}\tensor{u}{^a}\tensor{v}{^c}\right)}
        }{
            \sum_{i}\left(\tensor{g}{_i_i}\tensor{u}{^i}\tensor{u}{^i}\right)
            \sum_{i}\left(\tensor{g}{_i_i}\tensor{v}{^i}\tensor{v}{^i}\right)
            -\left(\sum_{i}\left(\tensor{g}{_i_i}\tensor{v}{^i}\tensor{u}{^i}\right)\right)^2
        } \\
        &=
        \frac{
            \sum_{i,a,b,c}{\left(\tensor{g}{_i_i}\tensor{u}{^i}\tensor{R}{^i_c_a_b}\tensor{v}{^b}\tensor{u}{^a}\tensor{v}{^c}\right)}
        }{
            \sum_{i}\left(\tensor{g}{_i_i}\tensor{u}{^i}\tensor{u}{^i}\right)
            \sum_{i}\left(\tensor{g}{_i_i}\tensor{v}{^i}\tensor{v}{^i}\right)
            -\left(\sum_{i}\left(\tensor{g}{_i_i}\tensor{v}{^i}\tensor{u}{^i}\right)\right)^2
        } \\
    \end{align*}
\end{proof}
\paragraph{CurvatureParameter}
It can be seen that $\operatorname{sec}\left(p\right) = \kappa = \sign{\left(k\right)}k^2$.
Hence, when provided $\kappa$, $k$ can be determined and used to evaluate the model.

\end{document}